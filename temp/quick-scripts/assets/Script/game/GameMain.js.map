{"version":3,"sources":["GameMain.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/game","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport SceneManager from \"../SceneManager\";\nimport ResourceManager from \"../managers/ResourceManager\";\n\nconst {ccclass, property} = cc._decorator;\n// 摄像机移动方向\nenum Dir {\n    UP,\n    DOWN,\n    NONE\n}\n@ccclass\nexport default class GameMain extends cc.Component {\n\n    // LIFE-CYCLE CALLBACKS:\n    @property(cc.Node)\n    rootNode: cc.Node = null;\n    @property(cc.Prefab)\n    gamePrefab: cc.Prefab = null;\n    @property(cc.Label)\n    levelLabel: cc.Label = null;\n    @property(cc.Camera)\n    mainCamera: cc.Camera = null;\n\n    // private ballIsDown\n    public level: number = 0;\n    private ballIsDown: boolean = false;\n    private startTime: boolean = false;\n    private timeUsed: number = 0;\n\n    private _curDir: Dir = Dir.NONE;\n\n    private levelData: any = null;\n    async onLoad () {\n        SceneManager.getInstance().setRoot(this.rootNode);\n        SceneManager.getInstance().runScene(this.gamePrefab);\n        // 加载关卡数据\n        let levelData: cc.JsonAsset = await ResourceManager.getInstance().loadResourceByUrl(`level${SceneManager.getInstance().getLevel()}`,cc.JsonAsset);\n        this.levelData = levelData.json;\n        console.log(\"levelData is \",this.levelData);\n        cc.director.on(\"ballToHole\",this.overHandle);\n        cc.director.on(\"ballToBoard\",this.ballToBoardHandle,this);\n        cc.director.on(\"ballToLand\",this.ballToLandHandle,this);\n    }\n    private ballToLandHandle(): void {\n        this.startTime = false;\n    }\n    private ballToBoardHandle(): void {\n        if(!this.ballIsDown) {\n            this.ballIsDown = true;\n            this.startTime = true;\n            this.levelLabel.string = \"00:00\";\n            \n            let scaleAnim: cc.AnimationClip = this.levelLabel.node.getComponent(cc.Animation).getClips()[1];\n            if(scaleAnim) {\n                this.levelLabel.node.getComponent(cc.Animation).play(scaleAnim.name);\n            }\n        }\n    }\n    // 游戏结束\n    private overHandle(): void {\n        this.startTime = false;\n    }\n    start () {\n        cc.director.on(\"up\",this.upCamera,this);\n        cc.director.on(\"down\",this.downCamera,this);\n        cc.director.on(\"none\",this.cameraStop,this);\n    }\n    set CurDir(dir: Dir) {\n        switch(dir) {\n            case Dir.UP:\n                this._curDir = Dir.UP;\n                break;\n            case Dir.DOWN:\n                this._curDir = Dir.DOWN;\n                break;\n            case Dir.NONE:\n                this._curDir = Dir.NONE;\n                break;\n        }\n    }\n    private upCamera(): void {\n        this.CurDir = Dir.UP;\n    }\n    private downCamera(): void {\n        this.CurDir = Dir.DOWN;\n    }\n    private cameraStop(): void {\n        this.CurDir = Dir.NONE;\n    }\n    private updateLevelOrTime(dt: number): void {\n        let self = this;\n        if(self.startTime) {\n            self.timeUsed += dt;\n            // self.timeUsed = Math.floor(self.timeUsed);\n            let minutes: number = Math.floor(self.timeUsed / 60);\n            let seconds: number = Math.floor(self.timeUsed % 60);\n            if(minutes < 10) {\n                if(seconds < 10) {\n                    self.levelLabel.string = `0${minutes}:0${seconds}`;\n                } else {\n                    self.levelLabel.string = `0${minutes}:${seconds}`;\n                }\n            } else {\n                if(seconds < 10) {\n                    self.levelLabel.string = `${minutes}:0${seconds}`;\n                } else {\n                    self.levelLabel.string = `${minutes}:${seconds}`;\n                }\n            }\n        }\n    }\n    onDestroy(): void {\n        cc.director.off(\"over\",this.overHandle);\n        cc.director.off(\"ballToBoard\",this.ballToBoardHandle,this);\n        cc.director.off(\"ballToLand\",this.ballToLandHandle,this);\n        cc.director.off(\"up\",this.upCamera,this);\n        cc.director.off(\"down\",this.downCamera,this);\n        cc.director.off(\"none\",this.cameraStop,this);\n    }\n    update (dt) {\n        this.updateLevelOrTime(dt);\n        switch(this._curDir) {\n            case Dir.UP:\n                this.mainCamera.node.y += dt * 200;\n                break;\n            case Dir.DOWN:\n                this.mainCamera.node.y -= dt * 200;\n                break;\n            case Dir.NONE:\n                break;    \n        }\n    }\n}\n"]}