{"version":3,"sources":["../../../../assets/Script/assets/Script/Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["import ResourceManager from \"./managers/ResourceManager\";\nimport SceneManager from \"./SceneManager\";\n\nconst {ccclass, property} = cc._decorator;\nenum Direction {\n    LEFT,\n    UP,\n    RIGHT,\n    DOWN,\n    NONE\n}\nenum GameState {\n    INIT,\n    BEGIN,\n    END\n}\n@ccclass\nexport default class Game extends cc.Component {\n\n    // LIFE-CYCLE CALLBACKS:\n    @property({type: cc.Node})\n    board: cc.Node = null;\n    @property({type: cc.Node})\n    ball: cc.Node = null;\n    @property({type: cc.Node})\n    ballp: cc.Node = null;\n    @property({type: cc.Prefab})\n    hole: cc.Prefab = null;\n    @property({type: cc.AudioClip})\n    ballFallAudio: cc.AudioClip = null;\n    @property(cc.Node)\n    bg: cc.Node = null;\n    @property(cc.Label)\n    levelLabel: cc.Label = null;\n    @property(cc.Camera)\n    mainCamera: cc.Camera = null;\n    @property(cc.Prefab)\n    holeWin: cc.Prefab = null;\n    @property(cc.Prefab)\n    holeLose: cc.Prefab = null;\n    @property(cc.Node)\n    holeCon: cc.Node = null;\n\n    private speed: number = 1;\n    \n    private canMove: boolean = true;\n\n    private dir: Direction = Direction.NONE;\n    private over: boolean = false;\n    private curState: GameState = GameState.INIT;\n    // 小球是否下落完毕\n    private ballIsDown: boolean = false;\n    private levelData: any = null;\n\n    private startTime: boolean = false;\n    private timeUsed: number = 0;\n    \n\n    private gridMap: cc.Vec2[][];\n    private readonly gridWidth: number = 70;\n    private readonly gridHeight: number = 70;\n\n    private loseHolePool: cc.NodePool = null;\n    private poolDeep: number = 20;\n\n    private holeWinNode: cc.Node = null;\n\n    async onLoad () {\n        this.gridMap = [];\n        cc.macro.ENABLE_WEBGL_ANTIALIAS = true;\n        cc.director.getPhysicsManager().enabled = true;\n        let self = this;\n        console.log(\"bg is \",this.bg);\n        cc.director.on(\"ballToBoard\",this.ballToBoardHandle,this);\n        // 加载关卡数据\n        let levelData: cc.JsonAsset = await ResourceManager.getInstance().loadResourceByUrl(`level${SceneManager.getInstance().getLevel()}`,cc.JsonAsset);\n        this.levelData = levelData.json;\n        console.log(\"levelData is \",this.levelData);\n        cc.director.on(\"ballToHole\",this.overHandle,this);\n        cc.director.on(\"ballToBoard\",this.ballToBoardHandle,this);\n        cc.director.on(\"ballToLand\",this.ballToLandHandle,this);\n\n        // 初始化相关代码\n        this.initHoleGrid();\n        this.initHolePoolForLose();\n        this.initHole();\n        console.log(\"gridMap is \",this.gridMap);\n\n        // cc.tween(this.holeWinNode).to({\n        //     y: self.holeWinNode.height\n        // })\n    }\n    // 初始化洞穴网格\n    private initHoleGrid(): void {\n        if(this.levelData) {\n            // 列\n            let col: number = this.levelData.col;\n            // 行\n            let row: number = this.levelData.row;\n            for(let i = 0; i < row; i++) {\n                this.gridMap[i] = [];\n                for(let j = 0; j < col; j++) {\n                    let pos: cc.Vec2 = new cc.Vec2();\n                    pos.x = this.gridWidth / 2 + j * this.gridWidth;\n                    pos.y = this.gridHeight / 2 + i * this.gridHeight;\n                    this.gridMap[i].push(pos);\n                    // this.gridMap[i][j] = pos;\n                }\n            }\n        }\n    }\n    // 初始化失败洞穴节点池\n    private initHolePoolForLose(): void {\n        this.loseHolePool = new cc.NodePool();\n        for(let i = 0; i < this.poolDeep; i++) {\n            let loseNode: cc.Node = cc.instantiate(this.holeLose);\n            this.loseHolePool.put(loseNode);\n            // this.holeCon.addChild(loseNode);\n        }\n    }\n    // 初始化终点洞穴,障碍洞穴\n    private initHole(): void {\n        if(this.levelData) {\n            let objects: any[] = this.levelData.objects;\n            for(let i = 0; i < objects.length; i++) {\n                if(i === 0) {\n                    // 初始化终点洞穴\n                    let posObj: any = objects[i].pos;\n                    this.holeWinNode = cc.instantiate(this.holeWin);\n                    this.holeCon.addChild(this.holeWinNode);\n                    this.holeWinNode.setPosition(this.gridMap[posObj.row][posObj.col]);\n                } else {\n                    let posObj: any = objects[i].pos;\n                    let loseHoleNode: cc.Node = this.loseHolePool.get();\n                    if(loseHoleNode) {\n                        loseHoleNode.setPosition(this.gridMap[posObj.row][posObj.col]);\n                        this.holeCon.addChild(loseHoleNode);\n                    }\n                }\n            }\n        }\n        // this.ball.zIndex = this.ball.parent\n    }\n    \n    private ballToLandHandle(): void {\n        this.startTime = false;\n    }\n    // 游戏结束\n    private overHandle(): void {\n        this.startTime = false;\n    }\n    private ballToBoardHandle(): void {\n        let self = this;\n        if(!self.ballIsDown) {\n            self.ballIsDown = true;\n            self.levelLabel.string = \"00:00\";\n            cc.tween(this.ballp).to(0.5,{\n                opacity: 0\n            }).start();\n            let scaleAnim: cc.AnimationClip = self.levelLabel.node.getComponent(cc.Animation).getClips()[1];\n            self.levelLabel.node.getComponent(cc.Animation).play(scaleAnim.name);\n            cc.audioEngine.play(self.ballFallAudio,false,0.5);\n        }\n    }\n    private set CurState(state: GameState) {\n        switch(state) {\n            case GameState.INIT:\n                this.curState = GameState.INIT;\n                break;\n            case GameState.BEGIN:\n                this.curState = GameState.BEGIN;\n                break;\n            case GameState.END:\n                this.curState = GameState.END;\n                this.gameOver();\n                break;\n        }\n    }\n    private gameOver(): void {\n        this.canMove = false;\n        this.over = true;\n        this.Dir = Direction.NONE;\n        this.startTime = false;\n    }\n    // start 函数\n    start () {\n        // cc.audioEngine.playMusic(this.bgm,true);\n        let self = this;\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\n\n        cc.director.on(\"ballToHole\",this.ballToHoleHandle,this);  \n    }\n    private ballToHoleHandle(): void {\n        let self = this;\n        if(!self.over) {\n            // 关闭物理系统\n            cc.director.getPhysicsManager().enabled = false;\n            self.CurState = GameState.END;\n            self.canMove = false;\n            self.over = true;\n            self.Dir = Direction.NONE;\n            let worldPosition: cc.Vec2 = self.holeCon.convertToWorldSpace(cc.v2(self.holeWinNode.x,self.holeWinNode.y));\n            let localPosition: cc.Vec2 = self.node.convertToNodeSpaceAR(worldPosition);\n            cc.tween(self.ball).to(0.5,{\n                x: localPosition.x,\n                y: localPosition.y\n            }).call(() => {\n                console.log(\"游戏结束\");\n                // \n                cc.tween(self.ball).to(0.5,{\n                    scale: 0\n                }).start();\n            }).start();\n            self.board.getComponent(cc.Animation).play(\"boardW\");\n            let winAnimName: string = self.holeWinNode.getComponent(cc.Animation).getClips()[2].name;\n            self.holeWinNode.getComponent(cc.Animation).play(winAnimName);\n            // cc.director.emit(\"over\");\n        }\n    }\n    set Dir(dir: Direction) {\n        switch(dir) {\n            case Direction.LEFT:\n                this.dir = Direction.LEFT;\n                break;\n            case Direction.RIGHT:\n                this.dir = Direction.RIGHT;\n                break;\n            case Direction.UP:\n                this.dir = Direction.UP;\n                break;\n            case Direction.DOWN:\n                this.dir = Direction.DOWN;\n                break;\n            case Direction.NONE:\n                this.dir = Direction.NONE;\n                break;    \n        }\n    }\n    private onKeyDown(e: cc.Event.EventKeyboard): void {\n        console.log(e.keyCode);\n        if(this.canMove) {\n            this.startTime = true;\n            switch(e.keyCode) {\n                case 37:\n                    this.Dir = Direction.LEFT;\n                    cc.director.emit(\"none\");\n                    break;\n                case 38:\n                    this.Dir = Direction.UP;\n                    cc.director.emit(\"up\");\n                    break;\n                case 39:\n                    this.Dir = Direction.RIGHT;\n                    cc.director.emit(\"none\");\n                    // this.board.angle -= \n                    break;\n                case 40:\n                    cc.director.emit(\"down\");\n                    this.Dir = Direction.DOWN;\n                    break;            \n            }\n        }\n    }\n    private onKeyUp(e: cc.Event.EventKeyboard): void {\n        this.Dir = Direction.NONE;\n        cc.director.emit(\"none\");\n    }\n    onDestroy(): void {\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\n        cc.director.off(\"ballToHole\",this.ballToHoleHandle,this);\n        cc.director.off(\"ballToBoard\",this.ballToBoardHandle,this);\n    }\n    private updateLevelOrTime(dt: number): void {\n        let self = this;\n        if(self.startTime) {\n            self.timeUsed += dt;\n            // self.timeUsed = Math.floor(self.timeUsed);\n            let minutes: number = Math.floor(self.timeUsed / 60);\n            let seconds: number = Math.floor(self.timeUsed % 60);\n            if(minutes < 10) {\n                if(seconds < 10) {\n                    self.levelLabel.string = `0${minutes}:0${seconds}`;\n                } else {\n                    self.levelLabel.string = `0${minutes}:${seconds}`;\n                }\n            } else {\n                if(seconds < 10) {\n                    self.levelLabel.string = `${minutes}:0${seconds}`;\n                } else {\n                    self.levelLabel.string = `${minutes}:${seconds}`;\n                }\n            }\n        }\n    }\n    update (dt) {\n        let self = this;\n        this.updateLevelOrTime(dt);\n        switch(this.dir) {\n            case Direction.LEFT:\n                if(this.board.angle <= 20) {\n                    this.board.angle += this.speed;\n                }\n                break;\n            case Direction.RIGHT:\n                if(this.board.angle >= -20) {\n                    this.board.angle -= this.speed;\n                }\n                break;\n            case Direction.UP:\n                this.board.y += dt * 200;\n                this.mainCamera.node.y += dt * 200;\n                break;\n            case Direction.DOWN:\n                this.board.y -= dt * 200;\n                this.mainCamera.node.y -= dt * 200;\n                break;\n        }\n    }\n}\n"]}